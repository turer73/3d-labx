---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import { getLanguage } from "../../lib/api";
import { getTranslations, type Language } from "../../lib/translations";

export const prerender = false;

const lang = Astro.locals?.lang || getLanguage(Astro.request);
const t = getTranslations(lang);

// Page titles and descriptions by language
const pageMeta = {
  tr: {
    title: "Bambu Lab Slicer TÃ¼rkÃ§e Rehber - Profesyonel Ayarlar | 3D-labX",
    description: "Bambu Studio iÃ§in kapsamlÄ± TÃ¼rkÃ§e rehber. X1C, P1P, P1S, A1 serisi iÃ§in filament profilleri, kalibrasyon, volumetric flow ve sorun giderme."
  },
  en: {
    title: "Bambu Lab Slicer Guide - Professional Settings | 3D-labX",
    description: "Comprehensive Bambu Studio guide. Filament profiles, calibration, volumetric flow and troubleshooting for X1C, P1P, P1S, A1 series."
  },
  de: {
    title: "Bambu Lab Slicer Anleitung - Professionelle Einstellungen | 3D-labX",
    description: "Umfassende Bambu Studio Anleitung. Filament-Profile, Kalibrierung, volumetrischer Fluss und Fehlerbehebung fÃ¼r X1C, P1P, P1S, A1 Serie."
  }
};

const title = pageMeta[lang].title;
const description = pageMeta[lang].description;

// UI Texts by language
const ui = {
  tr: {
    home: "Ana Sayfa",
    guides: "Rehberler",
    current: "Bambu Lab",
    badge1: "Studio 1.10",
    badge2: "Pro Rehber",
    headerTitle: "Bambu Lab",
    headerGradient: "TÃ¼rkÃ§e Rehber",
    headerDesc: "X1C, P1P, P1S ve A1 serisi yazÄ±cÄ±lar iÃ§in Bambu Studio ayarlarÄ±, filament profilleri ve kalibrasyon sÃ¼reÃ§lerini keÅŸfedin.",
    tabDashboard: "Genel BakÄ±ÅŸ",
    tabFilaments: "Filamentler",
    tabCalibration: "Kalibrasyon",
    tabTroubleshoot: "Sorun Giderme",
    ecosystemTitle: "Bambu Ekosistemi AvantajlarÄ±",
    ecosystemDesc: "DiÄŸer sistemlere gÃ¶re performans karÅŸÄ±laÅŸtÄ±rmasÄ±.",
    printTimeTitle: "BaskÄ± SÃ¼resi DaÄŸÄ±lÄ±mÄ±",
    printTimeDesc: "Optimize etmek iÃ§in nereye odaklanmalÄ±sÄ±nÄ±z?",
    speedRecord: "HÄ±z Rekoru",
    speedRecordDesc: "Bambu Lab X1C, 500mm/s hÄ±za ulaÅŸabilen dÃ¼nyanÄ±n en hÄ±zlÄ± CoreXY FDM yazÄ±cÄ±sÄ±dÄ±r. Flow Dynamics kalibrasyonu ile maksimum verim alÄ±n.",
    amsTip: "AMS Ä°pucu",
    amsTipDesc: "AMS ile TPU ve esnek filamentler KULLANILMAZ. Direkt olarak yazÄ±cÄ± kafasÄ±na takÄ±lmalÄ±dÄ±r. PTFE tÃ¼p iÃ§inden geÃ§irmeyin.",
    printerComparison: "Bambu Lab YazÄ±cÄ± KarÅŸÄ±laÅŸtÄ±rmasÄ±",
    feature: "Ã–zellik",
    maxSpeed: "Max HÄ±z",
    enclosure: "KapalÄ± Kabin",
    hardenedNozzle: "Hardened Nozzle",
    maxBedTemp: "Max Tabla SÄ±caklÄ±ÄŸÄ±",
    filamentTypes: "Filament TÃ¼rleri",
    calibrationSteps: "Kalibrasyon AdÄ±mlarÄ±",
    selectProblem: "YukarÄ±dan bir sorun seÃ§in"
  },
  en: {
    home: "Home",
    guides: "Guides",
    current: "Bambu Lab",
    badge1: "Studio 1.10",
    badge2: "Pro Guide",
    headerTitle: "Bambu Lab",
    headerGradient: "Complete Guide",
    headerDesc: "Discover Bambu Studio settings, filament profiles and calibration processes for X1C, P1P, P1S and A1 series printers.",
    tabDashboard: "Overview",
    tabFilaments: "Filaments",
    tabCalibration: "Calibration",
    tabTroubleshoot: "Troubleshooting",
    ecosystemTitle: "Bambu Ecosystem Advantages",
    ecosystemDesc: "Performance comparison with other systems.",
    printTimeTitle: "Print Time Distribution",
    printTimeDesc: "Where should you focus to optimize?",
    speedRecord: "Speed Record",
    speedRecordDesc: "Bambu Lab X1C is the world's fastest CoreXY FDM printer capable of 500mm/s. Get maximum efficiency with Flow Dynamics calibration.",
    amsTip: "AMS Tip",
    amsTipDesc: "TPU and flexible filaments should NOT be used with AMS. Must be loaded directly to the print head. Do not pass through PTFE tube.",
    printerComparison: "Bambu Lab Printer Comparison",
    feature: "Feature",
    maxSpeed: "Max Speed",
    enclosure: "Enclosure",
    hardenedNozzle: "Hardened Nozzle",
    maxBedTemp: "Max Bed Temp",
    filamentTypes: "Filament Types",
    calibrationSteps: "Calibration Steps",
    selectProblem: "Select a problem above"
  },
  de: {
    home: "Startseite",
    guides: "Anleitungen",
    current: "Bambu Lab",
    badge1: "Studio 1.10",
    badge2: "Pro Anleitung",
    headerTitle: "Bambu Lab",
    headerGradient: "Komplette Anleitung",
    headerDesc: "Entdecken Sie Bambu Studio Einstellungen, Filament-Profile und Kalibrierungsprozesse fÃ¼r X1C, P1P, P1S und A1 Serie Drucker.",
    tabDashboard: "Ãœbersicht",
    tabFilaments: "Filamente",
    tabCalibration: "Kalibrierung",
    tabTroubleshoot: "Fehlerbehebung",
    ecosystemTitle: "Bambu Ã–kosystem Vorteile",
    ecosystemDesc: "Leistungsvergleich mit anderen Systemen.",
    printTimeTitle: "Druckzeit Verteilung",
    printTimeDesc: "Worauf sollten Sie sich zur Optimierung konzentrieren?",
    speedRecord: "Geschwindigkeitsrekord",
    speedRecordDesc: "Bambu Lab X1C ist der schnellste CoreXY FDM-Drucker der Welt mit 500mm/s. Maximale Effizienz mit Flow Dynamics Kalibrierung.",
    amsTip: "AMS Tipp",
    amsTipDesc: "TPU und flexible Filamente sollten NICHT mit AMS verwendet werden. Muss direkt in den Druckkopf geladen werden. Nicht durch PTFE-Schlauch fÃ¼hren.",
    printerComparison: "Bambu Lab Drucker Vergleich",
    feature: "Eigenschaft",
    maxSpeed: "Max Geschwindigkeit",
    enclosure: "GehÃ¤use",
    hardenedNozzle: "GehÃ¤rtete DÃ¼se",
    maxBedTemp: "Max Betttemp",
    filamentTypes: "Filament Typen",
    calibrationSteps: "Kalibrierungsschritte",
    selectProblem: "WÃ¤hlen Sie oben ein Problem"
  }
};

const u = ui[lang];
---

<BaseLayout title={title} description={description}>
  <Header />

  <!-- Schema.org -->
  <script type="application/ld+json" set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": title,
    "description": description,
    "author": { "@type": "Organization", "name": "3D-labX" },
    "publisher": { "@type": "Organization", "name": "3D-labX", "url": "https://3d-labx.com" },
    "datePublished": "2026-02-02",
    "mainEntityOfPage": "https://3d-labx.com/rehberler/bambu-slicer-rehberi",
    "inLanguage": lang
  })} />

  <main class="bambu-guide">
    <div class="container">
      <!-- Breadcrumb -->
      <nav class="breadcrumb">
        <a href="/">{u.home}</a>
        <span>/</span>
        <a href="/rehberler">{u.guides}</a>
        <span>/</span>
        <span class="current">{u.current}</span>
      </nav>

      <!-- Header -->
      <header class="guide-header">
        <div class="version-badge">
          <span>{u.badge1}</span>
          <span class="dot">â€¢</span>
          <span>{u.badge2}</span>
        </div>
        <h1>{u.headerTitle} <span class="gradient-text">{u.headerGradient}</span></h1>
        <p class="header-desc">{u.headerDesc}</p>
      </header>

      <!-- Navigation Tabs -->
      <nav class="guide-tabs">
        <button class="tab-btn active" data-tab="dashboard">
          <span class="tab-icon">ğŸ“Š</span>
          <span>{u.tabDashboard}</span>
        </button>
        <button class="tab-btn" data-tab="filaments">
          <span class="tab-icon">ğŸ§¬</span>
          <span>{u.tabFilaments}</span>
        </button>
        <button class="tab-btn" data-tab="calibration">
          <span class="tab-icon">ğŸ¯</span>
          <span>{u.tabCalibration}</span>
        </button>
        <button class="tab-btn" data-tab="troubleshoot">
          <span class="tab-icon">ğŸ”§</span>
          <span>{u.tabTroubleshoot}</span>
        </button>
      </nav>

      <!-- Content Area -->
      <div class="guide-content">

        <!-- TAB 1: DASHBOARD -->
        <section id="tab-dashboard" class="tab-panel active">
          <div class="charts-grid">
            <!-- Feature Radar -->
            <div class="chart-card">
              <h3>{u.ecosystemTitle}</h3>
              <p class="chart-desc">{u.ecosystemDesc}</p>
              <div class="chart-container">
                <canvas id="radarChart"></canvas>
              </div>
            </div>

            <!-- Time Distribution -->
            <div class="chart-card">
              <h3>{u.printTimeTitle}</h3>
              <p class="chart-desc">{u.printTimeDesc}</p>
              <div class="chart-container">
                <canvas id="timeChart"></canvas>
              </div>
            </div>
          </div>

          <div class="tips-grid">
            <div class="tip-card tip-speed">
              <span class="tip-icon">ğŸš€</span>
              <div class="tip-content">
                <h4>{u.speedRecord}</h4>
                <p>{u.speedRecordDesc}</p>
              </div>
            </div>
            <div class="tip-card tip-quality">
              <span class="tip-icon">âš ï¸</span>
              <div class="tip-content">
                <h4>{u.amsTip}</h4>
                <p>{u.amsTipDesc}</p>
              </div>
            </div>
          </div>

          <!-- Printer Comparison -->
          <div class="comparison-section">
            <h3>ğŸ–¨ï¸ {u.printerComparison}</h3>
            <div class="comparison-table">
              <div class="comp-header">
                <span>{u.feature}</span>
                <span>X1C</span>
                <span>P1S</span>
                <span>A1</span>
              </div>
              <div class="comp-row">
                <span>{u.maxSpeed}</span>
                <span class="highlight">500 mm/s</span>
                <span>500 mm/s</span>
                <span>500 mm/s</span>
              </div>
              <div class="comp-row">
                <span>{u.enclosure}</span>
                <span class="check">âœ“</span>
                <span class="check">âœ“</span>
                <span class="cross">âœ—</span>
              </div>
              <div class="comp-row">
                <span>LiDAR</span>
                <span class="check">âœ“</span>
                <span class="cross">âœ—</span>
                <span class="cross">âœ—</span>
              </div>
              <div class="comp-row">
                <span>{u.hardenedNozzle}</span>
                <span class="check">âœ“</span>
                <span class="cross">âœ—</span>
                <span class="cross">âœ—</span>
              </div>
              <div class="comp-row">
                <span>{u.maxBedTemp}</span>
                <span>110Â°C</span>
                <span>100Â°C</span>
                <span>100Â°C</span>
              </div>
            </div>
          </div>
        </section>

        <!-- TAB 2: FILAMENTS -->
        <section id="tab-filaments" class="tab-panel">
          <div class="filament-layout">
            <!-- Filament List -->
            <div class="filament-list">
              <h3 class="list-title">{u.filamentTypes}</h3>

              <button class="filament-btn active" data-filament="0">
                <span class="fil-icon">ğŸŸ¢</span>
                <div class="fil-info">
                  <h4>PLA / PLA+</h4>
                  <p>Standart, kolay baskÄ±</p>
                </div>
              </button>

              <button class="filament-btn" data-filament="1">
                <span class="fil-icon">ğŸ”µ</span>
                <div class="fil-info">
                  <h4>PETG</h4>
                  <p>Mukavemet + esneklik</p>
                </div>
              </button>

              <button class="filament-btn" data-filament="2">
                <span class="fil-icon">ğŸŸ </span>
                <div class="fil-info">
                  <h4>ABS / ASA</h4>
                  <p>IsÄ± dayanÄ±mÄ±, dÄ±ÅŸ mekan</p>
                </div>
              </button>

              <button class="filament-btn" data-filament="3">
                <span class="fil-icon">âš«</span>
                <div class="fil-info">
                  <h4>PA-CF / PA-GF</h4>
                  <p>Karbon/Cam fiber naylon</p>
                </div>
              </button>

              <button class="filament-btn" data-filament="4">
                <span class="fil-icon">ğŸŸ£</span>
                <div class="fil-info">
                  <h4>TPU</h4>
                  <p>Esnek, AMS'siz kullanÄ±n</p>
                </div>
              </button>
            </div>

            <!-- Detail Panel -->
            <div class="filament-detail" id="filamentDetailPanel">
              <div class="filament-detail-content" id="filamentDetailContent">
                <!-- Default: PLA -->
              </div>
            </div>
          </div>
        </section>

        <!-- TAB 3: CALIBRATION -->
        <section id="tab-calibration" class="tab-panel">
          <div class="calibration-layout">
            <!-- Steps List -->
            <div class="cal-steps">
              <h3 class="steps-title">{u.calibrationSteps}</h3>

              <button class="cal-step-btn active" data-step="0">
                <span class="step-icon">ğŸ¯</span>
                <div class="step-info">
                  <h4>1. Flow Dynamics</h4>
                  <p>Pressure Advance otomatik</p>
                </div>
              </button>

              <button class="cal-step-btn" data-step="1">
                <span class="step-icon">ğŸŒŠ</span>
                <div class="step-info">
                  <h4>2. Flow Rate</h4>
                  <p>AkÄ±ÅŸ oranÄ± hassas ayar</p>
                </div>
              </button>

              <button class="cal-step-btn" data-step="2">
                <span class="step-icon">ğŸš€</span>
                <div class="step-info">
                  <h4>3. Max Volumetric</h4>
                  <p>HÄ±z limiti testi</p>
                </div>
              </button>

              <button class="cal-step-btn" data-step="3">
                <span class="step-icon">ğŸ“</span>
                <div class="step-info">
                  <h4>4. Motor Noise</h4>
                  <p>TitreÅŸim azaltma</p>
                </div>
              </button>

              <button class="cal-step-btn" data-step="4">
                <span class="step-icon">â†©ï¸</span>
                <div class="step-info">
                  <h4>5. Retraction</h4>
                  <p>Ä°pliklenme Ã¶nleme</p>
                </div>
              </button>
            </div>

            <!-- Detail Panel -->
            <div class="cal-detail" id="calDetailPanel">
              <div class="cal-detail-content" id="calDetailContent">
                <!-- Default: Flow Dynamics -->
              </div>
            </div>
          </div>
        </section>

        <!-- TAB 4: TROUBLESHOOT -->
        <section id="tab-troubleshoot" class="tab-panel">
          <div class="problems-grid">
            <button class="problem-btn" data-problem="adhesion">
              <span class="problem-icon">ğŸ“‹</span>
              <span class="problem-name">YapÄ±ÅŸmama</span>
            </button>
            <button class="problem-btn" data-problem="stringing">
              <span class="problem-icon">ğŸ•¸ï¸</span>
              <span class="problem-name">Ä°pliklenme</span>
            </button>
            <button class="problem-btn" data-problem="ghosting">
              <span class="problem-icon">ğŸ‘»</span>
              <span class="problem-name">Ghosting</span>
            </button>
            <button class="problem-btn" data-problem="clog">
              <span class="problem-icon">ğŸ”¥</span>
              <span class="problem-name">Nozzle TÄ±kanma</span>
            </button>
            <button class="problem-btn" data-problem="ams">
              <span class="problem-icon">ğŸ¨</span>
              <span class="problem-name">AMS HatasÄ±</span>
            </button>
            <button class="problem-btn" data-problem="layer">
              <span class="problem-icon">ğŸ“š</span>
              <span class="problem-name">Katman AyrÄ±lma</span>
            </button>
          </div>

          <div class="solution-panel" id="solutionPanel">
            <div class="solution-placeholder">
              <span>ğŸ‘†</span>
              <p>{u.selectProblem}</p>
            </div>
          </div>
        </section>

      </div>
    </div>
  </main>
</BaseLayout>

<style>
  .bambu-guide {
    padding: 120px 0 60px;
    min-height: 100vh;
  }

  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 0 20px;
  }

  /* Breadcrumb */
  .breadcrumb {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 24px;
    font-size: 0.85rem;
    color: var(--text-muted);
  }

  .breadcrumb a {
    color: var(--text-muted);
    text-decoration: none;
    transition: color 0.2s;
  }

  .breadcrumb a:hover { color: #00AE42; }
  .breadcrumb .current { color: var(--text-main); font-weight: 500; }

  /* Header */
  .guide-header {
    text-align: center;
    margin-bottom: 32px;
  }

  .version-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 6px 16px;
    background: rgba(0, 174, 66, 0.1);
    border: 1px solid rgba(0, 174, 66, 0.3);
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 600;
    color: #00AE42;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 16px;
  }

  .version-badge .dot { opacity: 0.5; }

  .guide-header h1 {
    font-size: 2.5rem;
    font-weight: 800;
    color: var(--text-main);
    margin-bottom: 12px;
  }

  .gradient-text {
    background: linear-gradient(135deg, #00AE42, #00c44a);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .header-desc {
    color: var(--text-muted);
    font-size: 1rem;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
  }

  /* Navigation Tabs */
  .guide-tabs {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
    margin-bottom: 24px;
  }

  .tab-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 12px 20px;
    background: var(--bg-card);
    border: 2px solid var(--border-soft);
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s;
  }

  .tab-btn:hover {
    border-color: #00AE42;
    color: #00AE42;
  }

  .tab-btn.active {
    background: rgba(0, 174, 66, 0.1);
    border-color: #00AE42;
    color: #00AE42;
  }

  .tab-icon { font-size: 1.1rem; }

  /* Content Area */
  .guide-content {
    background: var(--bg-card);
    border: 1px solid var(--border-soft);
    border-radius: 24px;
    padding: 32px;
    min-height: 500px;
  }

  .tab-panel {
    display: none;
    animation: fadeIn 0.3s ease;
  }

  .tab-panel.active { display: block; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Dashboard Tab */
  .charts-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 24px;
    margin-bottom: 24px;
  }

  .chart-card {
    background: var(--bg-soft);
    border: 1px solid var(--border-soft);
    border-radius: 16px;
    padding: 24px;
  }

  .chart-card h3 {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-main);
    margin-bottom: 4px;
  }

  .chart-desc {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 16px;
  }

  .chart-container {
    position: relative;
    height: 250px;
  }

  .tips-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    margin-bottom: 32px;
  }

  .tip-card {
    display: flex;
    gap: 16px;
    padding: 16px;
    border-radius: 12px;
    border: 1px solid;
  }

  .tip-speed {
    background: rgba(0, 174, 66, 0.1);
    border-color: rgba(0, 174, 66, 0.3);
  }

  .tip-quality {
    background: rgba(249, 115, 22, 0.1);
    border-color: rgba(249, 115, 22, 0.3);
  }

  .tip-icon { font-size: 1.5rem; }

  .tip-content h4 {
    font-size: 0.9rem;
    font-weight: 700;
    margin-bottom: 4px;
  }

  .tip-speed h4 { color: #00AE42; }
  .tip-quality h4 { color: #f97316; }

  .tip-content p {
    font-size: 0.85rem;
    color: var(--text-muted);
    line-height: 1.5;
  }

  /* Comparison Table */
  .comparison-section {
    margin-top: 24px;
  }

  .comparison-section h3 {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--text-main);
    margin-bottom: 16px;
  }

  .comparison-table {
    background: var(--bg-soft);
    border: 1px solid var(--border-soft);
    border-radius: 12px;
    overflow: hidden;
  }

  .comp-header, .comp-row {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    padding: 12px 16px;
  }

  .comp-header {
    background: var(--bg-card);
    font-weight: 700;
    font-size: 0.85rem;
    color: var(--text-main);
    border-bottom: 1px solid var(--border-soft);
  }

  .comp-row {
    font-size: 0.85rem;
    color: var(--text-muted);
    border-bottom: 1px solid var(--border-soft);
  }

  .comp-row:last-child { border-bottom: none; }

  .comp-row span:first-child { color: var(--text-main); }

  .check { color: #00AE42; font-weight: bold; }
  .cross { color: #ef4444; }
  .highlight { color: #00AE42; font-weight: 700; }

  /* Filament Tab */
  .filament-layout {
    display: grid;
    grid-template-columns: 260px 1fr;
    gap: 24px;
  }

  .list-title {
    font-size: 0.8rem;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 16px;
  }

  .filament-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .filament-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    background: var(--bg-soft);
    border: 2px solid var(--border-soft);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
  }

  .filament-btn:hover {
    border-color: #00AE42;
  }

  .filament-btn.active {
    border-color: #00AE42;
    background: rgba(0, 174, 66, 0.1);
  }

  .fil-icon { font-size: 1.5rem; }

  .fil-info h4 {
    font-size: 0.9rem;
    font-weight: 700;
    color: var(--text-main);
    margin-bottom: 2px;
  }

  .fil-info p {
    font-size: 0.75rem;
    color: var(--text-muted);
  }

  .filament-detail {
    background: var(--bg-soft);
    border: 1px solid var(--border-soft);
    border-radius: 16px;
    padding: 24px;
  }

  /* Parameter Cards Grid */
  .param-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 12px;
    margin: 20px 0;
  }

  .param-card {
    background: var(--bg-card);
    border: 1px solid var(--border-soft);
    border-radius: 14px;
    padding: 16px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    transition: all 0.2s ease;
  }

  .param-card:hover {
    border-color: var(--border-soft);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
  }

  .param-icon-wrap {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .param-icon-wrap.nozzle {
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.15), rgba(239, 68, 68, 0.05));
    color: #ef4444;
  }

  .param-icon-wrap.bed {
    background: linear-gradient(135deg, rgba(249, 115, 22, 0.15), rgba(249, 115, 22, 0.05));
    color: #f97316;
  }

  .param-icon-wrap.fan {
    background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(59, 130, 246, 0.05));
    color: #3b82f6;
  }

  .param-icon-wrap.speed {
    background: linear-gradient(135deg, rgba(0, 174, 66, 0.15), rgba(0, 174, 66, 0.05));
    color: #00AE42;
  }

  .param-icon-wrap svg {
    width: 24px;
    height: 24px;
    flex-shrink: 0;
  }

  .param-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
  }

  .param-label {
    font-size: 0.7rem;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .param-value {
    font-size: 1.25rem;
    font-weight: 800;
    color: var(--text-main);
  }

  .param-unit {
    font-size: 0.7rem;
    font-weight: 500;
    color: var(--text-muted);
    margin-left: 2px;
  }

  /* Info Cards Grid */
  .info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-top: 16px;
  }

  .info-card {
    background: var(--bg-card);
    border: 1px solid var(--border-soft);
    border-radius: 12px;
    padding: 14px 16px;
    display: flex;
    align-items: center;
    gap: 14px;
  }

  .info-card.full-width {
    grid-column: 1 / -1;
  }

  .info-icon-wrap {
    width: 40px;
    height: 40px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .info-icon-wrap.chamber {
    background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(139, 92, 246, 0.05));
    color: #8b5cf6;
  }

  .info-icon-wrap.plate {
    background: linear-gradient(135deg, rgba(236, 72, 153, 0.15), rgba(236, 72, 153, 0.05));
    color: #ec4899;
  }

  .info-icon-wrap.dry {
    background: linear-gradient(135deg, rgba(234, 179, 8, 0.15), rgba(234, 179, 8, 0.05));
    color: #eab308;
  }

  .info-icon-wrap svg {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
  }

  .info-content {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .info-label {
    font-size: 0.7rem;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .info-value {
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-main);
  }

  .info-value.mono {
    font-family: 'SF Mono', 'Fira Code', monospace;
    font-size: 0.85rem;
  }

  /* Alert Boxes */
  .alert-box {
    display: flex;
    gap: 14px;
    padding: 16px 18px;
    border-radius: 12px;
    margin-top: 16px;
  }

  .alert-box.warning {
    background: linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(239, 68, 68, 0.05));
    border: 1px solid rgba(239, 68, 68, 0.25);
  }

  .alert-box.tip {
    background: linear-gradient(135deg, rgba(0, 174, 66, 0.1), rgba(0, 174, 66, 0.05));
    border: 1px solid rgba(0, 174, 66, 0.25);
  }

  .alert-icon {
    width: 36px;
    height: 36px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .alert-box.warning .alert-icon {
    background: rgba(239, 68, 68, 0.15);
    color: #ef4444;
  }

  .alert-box.tip .alert-icon {
    background: rgba(0, 174, 66, 0.15);
    color: #00AE42;
  }

  .alert-icon svg {
    width: 18px;
    height: 18px;
    flex-shrink: 0;
  }

  .alert-content h4 {
    font-size: 0.85rem;
    font-weight: 700;
    margin-bottom: 4px;
  }

  .alert-box.warning .alert-content h4 {
    color: #f87171;
  }

  .alert-box.tip .alert-content h4 {
    color: #00AE42;
  }

  .alert-content p {
    font-size: 0.85rem;
    color: var(--text-muted);
    line-height: 1.6;
  }

  /* Legacy Warning Box (for other sections) */
  .warning-box {
    display: flex;
    gap: 12px;
    padding: 16px;
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
    border-radius: 12px;
    margin-top: 16px;
  }

  .warning-box.info {
    background: rgba(0, 174, 66, 0.1);
    border-color: rgba(0, 174, 66, 0.3);
  }

  .warning-box h4 {
    font-size: 0.85rem;
    font-weight: 700;
    color: #f87171;
    margin-bottom: 4px;
  }

  .warning-box.info h4 {
    color: #00AE42;
  }

  .warning-box p {
    font-size: 0.85rem;
    color: var(--text-muted);
    line-height: 1.5;
  }

  /* Calibration Tab */
  .calibration-layout {
    display: grid;
    grid-template-columns: 280px 1fr;
    gap: 24px;
  }

  .steps-title {
    font-size: 0.8rem;
    font-weight: 700;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 16px;
  }

  .cal-steps {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .cal-step-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 16px;
    background: var(--bg-soft);
    border: 2px solid var(--border-soft);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
  }

  .cal-step-btn:hover {
    border-color: #00AE42;
  }

  .cal-step-btn.active {
    border-color: #00AE42;
    background: rgba(0, 174, 66, 0.1);
  }

  .step-icon { font-size: 1.5rem; }

  .step-info h4 {
    font-size: 0.9rem;
    font-weight: 700;
    color: var(--text-main);
    margin-bottom: 2px;
  }

  .step-info p {
    font-size: 0.75rem;
    color: var(--text-muted);
  }

  .cal-detail {
    background: var(--bg-soft);
    border: 1px solid var(--border-soft);
    border-radius: 16px;
    padding: 24px;
  }

  .detail-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
  }

  .detail-icon { font-size: 2rem; }

  .detail-header h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-main);
  }

  .detail-desc {
    font-size: 1rem;
    color: #00AE42;
    font-weight: 500;
    margin-bottom: 20px;
  }

  .detail-steps {
    background: var(--bg-card);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
  }

  .detail-steps h4 {
    font-size: 0.9rem;
    font-weight: 700;
    color: var(--text-main);
    margin-bottom: 12px;
  }

  .detail-steps ol {
    list-style: decimal;
    padding-left: 20px;
    color: var(--text-muted);
    font-size: 0.9rem;
    line-height: 1.8;
  }

  .detail-steps strong { color: var(--text-main); }

  .detail-tip {
    display: flex;
    gap: 12px;
    padding: 16px;
    background: rgba(0, 174, 66, 0.1);
    border: 1px solid rgba(0, 174, 66, 0.3);
    border-radius: 12px;
  }

  .detail-tip span { font-size: 1.25rem; }

  .detail-tip p {
    font-size: 0.9rem;
    color: var(--text-main);
    line-height: 1.5;
  }

  /* Troubleshoot Tab */
  .problems-grid {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 12px;
    margin-bottom: 24px;
  }

  .problem-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 20px 12px;
    background: var(--bg-soft);
    border: 2px solid var(--border-soft);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s;
  }

  .problem-btn:hover {
    border-color: #00AE42;
    transform: translateY(-2px);
  }

  .problem-btn.active {
    border-color: #00AE42;
    background: rgba(0, 174, 66, 0.1);
  }

  .problem-icon { font-size: 1.75rem; }

  .problem-name {
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--text-main);
    text-align: center;
  }

  .solution-panel {
    background: var(--bg-soft);
    border: 1px solid var(--border-soft);
    border-radius: 16px;
    padding: 32px;
    min-height: 200px;
  }

  .solution-placeholder {
    text-align: center;
    color: var(--text-muted);
  }

  .solution-placeholder span {
    font-size: 2rem;
    display: block;
    margin-bottom: 8px;
  }

  .solution-content {
    animation: fadeIn 0.3s ease;
  }

  .solution-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 20px;
  }

  .solution-header span { font-size: 2rem; }

  .solution-header h3 {
    font-size: 1.25rem;
    font-weight: 700;
    color: #ef4444;
  }

  .solution-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
  }

  .cause-box, .fix-box {
    padding: 20px;
    border-radius: 12px;
  }

  .cause-box {
    background: rgba(239, 68, 68, 0.1);
    border: 1px solid rgba(239, 68, 68, 0.3);
  }

  .fix-box {
    background: rgba(0, 174, 66, 0.1);
    border: 1px solid rgba(0, 174, 66, 0.3);
  }

  .cause-box h4 { color: #ef4444; }
  .fix-box h4 { color: #00AE42; }

  .cause-box h4, .fix-box h4 {
    font-size: 0.8rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
  }

  .cause-box p, .fix-box p {
    font-size: 0.9rem;
    color: var(--text-main);
    line-height: 1.6;
  }

  /* Responsive */
  @media (max-width: 900px) {
    .charts-grid, .tips-grid, .solution-grid {
      grid-template-columns: 1fr;
    }

    .calibration-layout, .filament-layout {
      grid-template-columns: 1fr;
    }

    .problems-grid {
      grid-template-columns: repeat(3, 1fr);
    }

    .param-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .info-grid {
      grid-template-columns: 1fr;
    }

    .info-card.full-width {
      grid-column: auto;
    }

    .guide-header h1 {
      font-size: 2rem;
    }
  }

  @media (max-width: 640px) {
    .bambu-guide {
      padding-top: 100px;
    }

    .guide-content {
      padding: 20px;
    }

    .tab-btn {
      padding: 10px 14px;
      font-size: 0.8rem;
    }

    .tab-btn span:last-child {
      display: none;
    }

    .problems-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .param-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 8px;
    }

    .param-card {
      padding: 12px;
    }

    .param-icon-wrap {
      width: 40px;
      height: 40px;
    }

    .param-svg {
      width: 20px;
      height: 20px;
    }

    .param-value {
      font-size: 1.1rem;
    }

    .comp-header, .comp-row {
      grid-template-columns: 1.5fr 1fr 1fr 1fr;
      font-size: 0.75rem;
      padding: 10px 12px;
    }
  }
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script define:vars={{ lang }}>
  // i18n data
  window.bambuI18n = {
    lang: lang,
    // Filament data by language
    filaments: {
      tr: [
        {
          icon: 'ğŸŸ¢', name: 'PLA / PLA+',
          desc: 'En kolay baskÄ± alÄ±nan, Ã§evre dostu biyo-plastik. Prototipleme ve hobi projeleri iÃ§in ideal.',
          nozzle: '200-220', bed: '55-60', fan: '100', chamber: 'AÃ§Ä±k (KapaÄŸÄ± KaldÄ±rÄ±n)',
          maxVol: '21', dry: 'Gerekmez (45Â°C - 4h)', plate: 'Textured PEI', warning: null,
          tip: 'Heat Creep sorununu Ã¶nlemek iÃ§in kapalÄ± kabinli yazÄ±cÄ±larda (X1C, P1S) kapaÄŸÄ± aÃ§Ä±k bÄ±rakÄ±n. Aux fan AÃ‡IK olmalÄ±.'
        },
        {
          icon: 'ğŸ”µ', name: 'PETG',
          desc: 'PLA ve ABS arasÄ±nda denge. Mukavemetli, hafif esnek ve kolay baskÄ± alÄ±nÄ±r.',
          nozzle: '240-260', bed: '70-80', fan: '30-50', chamber: 'KapalÄ±',
          maxVol: '14', dry: 'Ã–nerilir (65Â°C - 8h)', plate: 'Textured PEI',
          warning: 'Smooth PEI plakaya Ã§ok yapÄ±ÅŸÄ±r ve yÃ¼zeyi bozabilir. Textured PEI kullanÄ±n.',
          tip: 'Fan hÄ±zÄ±nÄ± %30-50 arasÄ±nda tutun. Ã‡ok yÃ¼ksek fan kÃ¶ÅŸe kalkmasÄ±na neden olur.'
        },
        {
          icon: 'ğŸŸ ', name: 'ABS / ASA',
          desc: 'IsÄ± ve UV dayanÄ±mÄ± yÃ¼ksek. DÄ±ÅŸ mekan parÃ§alarÄ± ve fonksiyonel prototipler iÃ§in.',
          nozzle: '260-280', bed: '100-110', fan: '0-20', chamber: 'Tam KapalÄ±',
          maxVol: '18', dry: 'Åart (80Â°C - 4h)', plate: 'High Temp / Eng. Plate',
          warning: 'Aux Fan KAPALI olmalÄ±! Aksi halde katman ayrÄ±lmasÄ± ve kÃ¶ÅŸe kalkmasÄ± olur.',
          tip: 'Kabin sÄ±caklÄ±ÄŸÄ± minimum 35Â°C olmalÄ±. X1C\'de aktif Ä±sÄ±tma Ã¶zelliÄŸi kullanÄ±n. A1 ile ABS basÄ±lmaz.'
        },
        {
          icon: 'âš«', name: 'PA-CF / PA-GF',
          desc: 'Karbon veya cam fiber takviyeli naylon. Mekanik parÃ§alar iÃ§in ultra mukavemet.',
          nozzle: '280-300', bed: '100-110', fan: '0', chamber: 'KapalÄ±',
          maxVol: '10', dry: 'Kritik (80Â°C - 12h)', plate: 'Eng. Plate + YapÄ±ÅŸtÄ±rÄ±cÄ±',
          warning: 'Hardened Steel veya CHT nozzle ÅART! PirinÃ§ nozzle 1-2 baskÄ±da aÅŸÄ±nÄ±r.',
          tip: 'Naylon Ã§ok hÄ±zlÄ± nem Ã§eker. Kurutucudan direkt AMS\'e aktarÄ±n. AMS kurutma Ã¶zelliÄŸini AÃ‡IN.'
        },
        {
          icon: 'ğŸŸ£', name: 'TPU (Esnek)',
          desc: 'Esnek ve darbe emici. Koruyucu kÄ±lÄ±flar, contalar ve tekerlekler iÃ§in.',
          nozzle: '220-240', bed: '30-40', fan: '80-100', chamber: 'KapalÄ±',
          maxVol: '3.5', dry: 'Åart (55Â°C - 8h)', plate: 'Textured PEI',
          warning: 'AMS ile KULLANILMAZ! Direkt olarak yazÄ±cÄ± kafasÄ±na takÄ±lmalÄ±.',
          tip: 'BaskÄ± hÄ±zÄ±nÄ± 30-40 mm/s\'ye dÃ¼ÅŸÃ¼rÃ¼n. Retraction mesafesini 0.5-1mm yapÄ±n veya kapatÄ±n.'
        }
      ],
      en: [
        {
          icon: 'ğŸŸ¢', name: 'PLA / PLA+',
          desc: 'Easiest to print, eco-friendly bioplastic. Ideal for prototyping and hobby projects.',
          nozzle: '200-220', bed: '55-60', fan: '100', chamber: 'Open (Remove Lid)',
          maxVol: '21', dry: 'Not Required (45Â°C - 4h)', plate: 'Textured PEI', warning: null,
          tip: 'Keep the lid open on enclosed printers (X1C, P1S) to prevent heat creep. Aux fan should be ON.'
        },
        {
          icon: 'ğŸ”µ', name: 'PETG',
          desc: 'Balance between PLA and ABS. Strong, slightly flexible and easy to print.',
          nozzle: '240-260', bed: '70-80', fan: '30-50', chamber: 'Closed',
          maxVol: '14', dry: 'Recommended (65Â°C - 8h)', plate: 'Textured PEI',
          warning: 'Sticks too much to Smooth PEI and can damage the surface. Use Textured PEI.',
          tip: 'Keep fan speed between 30-50%. Too high fan causes corner lifting.'
        },
        {
          icon: 'ğŸŸ ', name: 'ABS / ASA',
          desc: 'High heat and UV resistance. For outdoor parts and functional prototypes.',
          nozzle: '260-280', bed: '100-110', fan: '0-20', chamber: 'Fully Enclosed',
          maxVol: '18', dry: 'Required (80Â°C - 4h)', plate: 'High Temp / Eng. Plate',
          warning: 'Aux Fan must be OFF! Otherwise layer separation and corner lifting occur.',
          tip: 'Chamber temp should be minimum 35Â°C. Use active heating on X1C. ABS cannot be printed on A1.'
        },
        {
          icon: 'âš«', name: 'PA-CF / PA-GF',
          desc: 'Carbon or glass fiber reinforced nylon. Ultra strength for mechanical parts.',
          nozzle: '280-300', bed: '100-110', fan: '0', chamber: 'Closed',
          maxVol: '10', dry: 'Critical (80Â°C - 12h)', plate: 'Eng. Plate + Glue Stick',
          warning: 'Hardened Steel or CHT nozzle REQUIRED! Brass nozzle wears out in 1-2 prints.',
          tip: 'Nylon absorbs moisture very quickly. Transfer directly from dryer to AMS. Turn ON AMS drying feature.'
        },
        {
          icon: 'ğŸŸ£', name: 'TPU (Flexible)',
          desc: 'Flexible and impact absorbing. For protective cases, gaskets and wheels.',
          nozzle: '220-240', bed: '30-40', fan: '80-100', chamber: 'Closed',
          maxVol: '3.5', dry: 'Required (55Â°C - 8h)', plate: 'Textured PEI',
          warning: 'NOT compatible with AMS! Must be loaded directly to print head.',
          tip: 'Reduce print speed to 30-40 mm/s. Set retraction distance to 0.5-1mm or disable it.'
        }
      ],
      de: [
        {
          icon: 'ğŸŸ¢', name: 'PLA / PLA+',
          desc: 'Am einfachsten zu drucken, umweltfreundlicher Biokunststoff. Ideal fÃ¼r Prototypen und Hobbyprojekte.',
          nozzle: '200-220', bed: '55-60', fan: '100', chamber: 'Offen (Deckel entfernen)',
          maxVol: '21', dry: 'Nicht erforderlich (45Â°C - 4h)', plate: 'Textured PEI', warning: null,
          tip: 'Deckel bei geschlossenen Druckern (X1C, P1S) offen lassen um Heat Creep zu vermeiden. Aux-LÃ¼fter sollte AN sein.'
        },
        {
          icon: 'ğŸ”µ', name: 'PETG',
          desc: 'Balance zwischen PLA und ABS. Stark, leicht flexibel und einfach zu drucken.',
          nozzle: '240-260', bed: '70-80', fan: '30-50', chamber: 'Geschlossen',
          maxVol: '14', dry: 'Empfohlen (65Â°C - 8h)', plate: 'Textured PEI',
          warning: 'Haftet zu stark auf Smooth PEI und kann die OberflÃ¤che beschÃ¤digen. Textured PEI verwenden.',
          tip: 'LÃ¼ftergeschwindigkeit zwischen 30-50% halten. Zu hohe LÃ¼fterdrehzahl verursacht Eckenabhebung.'
        },
        {
          icon: 'ğŸŸ ', name: 'ABS / ASA',
          desc: 'Hohe Hitze- und UV-BestÃ¤ndigkeit. FÃ¼r AuÃŸenteile und funktionale Prototypen.',
          nozzle: '260-280', bed: '100-110', fan: '0-20', chamber: 'VollstÃ¤ndig geschlossen',
          maxVol: '18', dry: 'Erforderlich (80Â°C - 4h)', plate: 'High Temp / Eng. Plate',
          warning: 'Aux-LÃ¼fter muss AUS sein! Sonst treten SchichtablÃ¶sung und Eckenabhebung auf.',
          tip: 'Kammertemperatur sollte mindestens 35Â°C sein. Aktive Heizung bei X1C verwenden. ABS kann nicht auf A1 gedruckt werden.'
        },
        {
          icon: 'âš«', name: 'PA-CF / PA-GF',
          desc: 'Kohlefaser- oder glasfaserverstÃ¤rktes Nylon. Ultra-Festigkeit fÃ¼r mechanische Teile.',
          nozzle: '280-300', bed: '100-110', fan: '0', chamber: 'Geschlossen',
          maxVol: '10', dry: 'Kritisch (80Â°C - 12h)', plate: 'Eng. Plate + Klebestift',
          warning: 'GehÃ¤rtete Stahl- oder CHT-DÃ¼se ERFORDERLICH! MessingdÃ¼se verschleiÃŸt in 1-2 Drucken.',
          tip: 'Nylon absorbiert sehr schnell Feuchtigkeit. Direkt vom Trockner zum AMS Ã¼bertragen. AMS-Trocknungsfunktion EINSCHALTEN.'
        },
        {
          icon: 'ğŸŸ£', name: 'TPU (Flexibel)',
          desc: 'Flexibel und stoÃŸabsorbierend. FÃ¼r SchutzhÃ¼llen, Dichtungen und RÃ¤der.',
          nozzle: '220-240', bed: '30-40', fan: '80-100', chamber: 'Geschlossen',
          maxVol: '3.5', dry: 'Erforderlich (55Â°C - 8h)', plate: 'Textured PEI',
          warning: 'NICHT kompatibel mit AMS! Muss direkt in den Druckkopf geladen werden.',
          tip: 'Druckgeschwindigkeit auf 30-40 mm/s reduzieren. RÃ¼ckzugsdistanz auf 0.5-1mm setzen oder deaktivieren.'
        }
      ]
    },
    // UI labels for filament detail
    filamentLabels: {
      tr: { nozzle: 'Nozzle', bed: 'Tabla', fan: 'Fan', maxVol: 'Max Vol', chamber: 'Kabin Durumu', plate: 'Tabla Tipi', dry: 'Kurutma AyarlarÄ±', warning: 'Dikkat!', tip: 'Pro Ä°pucu' },
      en: { nozzle: 'Nozzle', bed: 'Bed', fan: 'Fan', maxVol: 'Max Vol', chamber: 'Chamber Status', plate: 'Plate Type', dry: 'Drying Settings', warning: 'Warning!', tip: 'Pro Tip' },
      de: { nozzle: 'DÃ¼se', bed: 'Bett', fan: 'LÃ¼fter', maxVol: 'Max Vol', chamber: 'Kammerstatus', plate: 'Plattentyp', dry: 'Trocknungseinstellungen', warning: 'Achtung!', tip: 'Profi-Tipp' }
    },
    // Calibration steps
    calibration: {
      tr: [
        { icon: 'ğŸ¯', title: 'Flow Dynamics Kalibrasyon', desc: 'Bambu\'ya Ã¶zel otomatik Pressure Advance ve akÄ±ÅŸ kalibrasyonu.',
          steps: ['Bambu Studio\'da <strong>Calibration â†’ Flow Dynamics Calibration</strong> seÃ§in', 'KullanacaÄŸÄ±nÄ±z filamenti AMS\'e veya direkt kafaya takÄ±n', 'YazÄ±cÄ± modelinizi ve nozzle Ã§apÄ±nÄ± doÄŸrulayÄ±n', '<strong>"Start"</strong> butonuna tÄ±klayÄ±n', 'Kalibrasyon otomatik olarak PA ve akÄ±ÅŸ deÄŸerlerini hesaplar', 'SonuÃ§lar filament profiline otomatik kaydedilir'],
          tip: 'Her yeni filament markasÄ± veya tÃ¼rÃ¼ iÃ§in Flow Dynamics Ã§alÄ±ÅŸtÄ±rÄ±n. AynÄ± marka farklÄ± renkler iÃ§in genellikle gerekli deÄŸil.' },
        { icon: 'ğŸŒŠ', title: 'Flow Rate Kalibrasyon (Manuel)', desc: 'Hassas akÄ±ÅŸ ayarÄ± iÃ§in manuel kalibrasyon. Flow Dynamics\'ten sonra yapÄ±labilir.',
          steps: ['<strong>Calibration â†’ Flow Rate</strong> seÃ§in', 'Ä°lk test (Pass 1) kaba ayar iÃ§in bir kare Ä±zgara basar', 'En dÃ¼zgÃ¼n gÃ¶rÃ¼nen karenin numarasÄ±nÄ± seÃ§in', 'Ä°kinci test (Pass 2) hassas ayar iÃ§in daha kÃ¼Ã§Ã¼k aralÄ±klarla test eder', 'FormÃ¼l: <strong>Eski AkÄ±ÅŸ Ã— (100 + DeÄŸiÅŸim) / 100</strong>', 'DeÄŸeri filament profiline kaydedin'],
          tip: 'Ãœst yÃ¼zeyde boÅŸluk varsa akÄ±ÅŸ dÃ¼ÅŸÃ¼k, taÅŸma varsa akÄ±ÅŸ yÃ¼ksek demektir. Hedef: pÃ¼rÃ¼zsÃ¼z, dÃ¼z Ã¼st yÃ¼zey.' },
        { icon: 'ğŸš€', title: 'Max Volumetric Speed Testi', desc: 'Hotend\'in eritebileceÄŸi maksimum plastik miktarÄ±nÄ± belirler.',
          steps: ['<strong>Calibration â†’ Max Volumetric Speed</strong> seÃ§in', 'BaÅŸlangÄ±Ã§ ve bitiÅŸ deÄŸerlerini ayarlayÄ±n (PLA: 5-25 mmÂ³/s)', 'Test baskÄ±sÄ±nÄ± baÅŸlatÄ±n ve dikkatle izleyin', 'BaskÄ±nÄ±n matlaÅŸtÄ±ÄŸÄ± veya bozulduÄŸu noktayÄ± bulun', 'O noktadan <strong>2-3 mmÂ³/s Ã–NCE</strong>ki deÄŸeri kullanÄ±n', 'Bu deÄŸeri filament profilinde "Max Volumetric Speed" olarak girin'],
          tip: 'Bu deÄŸer TÃœM hÄ±z ayarlarÄ±nÄ± limitler. 500 mm/s ayarlasanÄ±z bile bu limit aÅŸÄ±lamaz. PLA: ~21, PETG: ~14, ABS: ~18 tipik deÄŸerler.' },
        { icon: 'ğŸ“', title: 'Vibration Compensation (Motor Noise)', desc: 'Input Shaper benzeri titreÅŸim azaltma. Ghosting sorununu Ã§Ã¶zer.',
          steps: ['<strong>Calibration â†’ Vibration Compensation</strong> seÃ§in', 'YazÄ±cÄ± otomatik olarak X ve Y eksenlerini test eder', 'Her eksen iÃ§in farklÄ± frekanslarda titreÅŸim oluÅŸturur', 'En az titreÅŸim olan frekanslarÄ± otomatik bulur', 'SonuÃ§lar makine profiline kaydedilir', 'Ghosting ciddi ÅŸekilde azalÄ±r'],
          tip: 'Bu kalibrasyon sadece Bambu Lab yazÄ±cÄ±larda Ã§alÄ±ÅŸÄ±r. LiDAR sensÃ¶rÃ¼ ile titreÅŸimi Ã¶lÃ§er (X1C). P1S/A1\'de ivmeÃ¶lÃ§er kullanÄ±r.' },
        { icon: 'â†©ï¸', title: 'Retraction Kalibrasyon', desc: 'Ä°pliklenme (stringing) sorununu Ã§Ã¶zmek iÃ§in geri Ã§ekme optimizasyonu.',
          steps: ['<strong>Calibration â†’ Retraction Test</strong> seÃ§in', 'Mesafe aralÄ±ÄŸÄ± belirleyin (Direct Drive: 0.5-2mm)', 'HÄ±z aralÄ±ÄŸÄ± belirleyin (25-45 mm/s)', 'Test baskÄ±sÄ±nÄ± yapÄ±n - Ä°ÄŸne kuleler veya Ä±zgara', 'Ä°pliklenme olmayan en DÃœÅÃœK deÄŸeri bulun', 'Bu deÄŸerleri filament profiline kaydedin'],
          tip: 'Bambu yazÄ±cÄ±lar Direct Drive olduÄŸu iÃ§in retraction mesafesi 0.5-2mm yeterli. Ã‡ok yÃ¼ksek deÄŸer hotend\'de tÄ±kanmaya neden olur.' }
      ],
      en: [
        { icon: 'ğŸ¯', title: 'Flow Dynamics Calibration', desc: 'Bambu-specific automatic Pressure Advance and flow calibration.',
          steps: ['In Bambu Studio, select <strong>Calibration â†’ Flow Dynamics Calibration</strong>', 'Load your filament into AMS or directly to the head', 'Verify your printer model and nozzle diameter', 'Click the <strong>"Start"</strong> button', 'Calibration automatically calculates PA and flow values', 'Results are automatically saved to the filament profile'],
          tip: 'Run Flow Dynamics for every new filament brand or type. Usually not needed for different colors of the same brand.' },
        { icon: 'ğŸŒŠ', title: 'Flow Rate Calibration (Manual)', desc: 'Manual calibration for precise flow adjustment. Can be done after Flow Dynamics.',
          steps: ['Select <strong>Calibration â†’ Flow Rate</strong>', 'First test (Pass 1) prints a grid of squares for coarse adjustment', 'Select the number of the smoothest looking square', 'Second test (Pass 2) tests with smaller intervals for fine adjustment', 'Formula: <strong>Old Flow Ã— (100 + Change) / 100</strong>', 'Save the value to the filament profile'],
          tip: 'If there are gaps on the top surface, flow is too low; if overflow, flow is too high. Goal: smooth, flat top surface.' },
        { icon: 'ğŸš€', title: 'Max Volumetric Speed Test', desc: 'Determines the maximum amount of plastic the hotend can melt.',
          steps: ['Select <strong>Calibration â†’ Max Volumetric Speed</strong>', 'Set start and end values (PLA: 5-25 mmÂ³/s)', 'Start the test print and watch carefully', 'Find the point where the print becomes matte or degrades', 'Use the value <strong>2-3 mmÂ³/s BEFORE</strong> that point', 'Enter this value as "Max Volumetric Speed" in the filament profile'],
          tip: 'This value limits ALL speed settings. Even if you set 500 mm/s, this limit cannot be exceeded. PLA: ~21, PETG: ~14, ABS: ~18 are typical values.' },
        { icon: 'ğŸ“', title: 'Vibration Compensation (Motor Noise)', desc: 'Input Shaper-like vibration reduction. Solves ghosting problems.',
          steps: ['Select <strong>Calibration â†’ Vibration Compensation</strong>', 'Printer automatically tests X and Y axes', 'Creates vibrations at different frequencies for each axis', 'Automatically finds frequencies with least vibration', 'Results are saved to the machine profile', 'Ghosting is significantly reduced'],
          tip: 'This calibration only works on Bambu Lab printers. Uses LiDAR sensor to measure vibration (X1C). Uses accelerometer on P1S/A1.' },
        { icon: 'â†©ï¸', title: 'Retraction Calibration', desc: 'Retraction optimization to solve stringing problems.',
          steps: ['Select <strong>Calibration â†’ Retraction Test</strong>', 'Set distance range (Direct Drive: 0.5-2mm)', 'Set speed range (25-45 mm/s)', 'Do the test print - Needle towers or grid', 'Find the LOWEST value without stringing', 'Save these values to the filament profile'],
          tip: 'Since Bambu printers are Direct Drive, retraction distance of 0.5-2mm is sufficient. Too high value causes clogging in the hotend.' }
      ],
      de: [
        { icon: 'ğŸ¯', title: 'Flow Dynamics Kalibrierung', desc: 'Bambu-spezifische automatische Pressure Advance und Fluss-Kalibrierung.',
          steps: ['In Bambu Studio <strong>Calibration â†’ Flow Dynamics Calibration</strong> wÃ¤hlen', 'Filament in AMS oder direkt in den Kopf laden', 'Druckermodell und DÃ¼sendurchmesser Ã¼berprÃ¼fen', 'Auf <strong>"Start"</strong>-SchaltflÃ¤che klicken', 'Kalibrierung berechnet automatisch PA- und Flusswerte', 'Ergebnisse werden automatisch im Filamentprofil gespeichert'],
          tip: 'Flow Dynamics fÃ¼r jede neue Filamentmarke oder -art ausfÃ¼hren. Normalerweise nicht nÃ¶tig fÃ¼r verschiedene Farben derselben Marke.' },
        { icon: 'ğŸŒŠ', title: 'Flow Rate Kalibrierung (Manuell)', desc: 'Manuelle Kalibrierung fÃ¼r prÃ¤zise Flusseinstellung. Kann nach Flow Dynamics durchgefÃ¼hrt werden.',
          steps: ['<strong>Calibration â†’ Flow Rate</strong> wÃ¤hlen', 'Erster Test (Pass 1) druckt ein Raster von Quadraten fÃ¼r Grobeinstellung', 'Die Nummer des glattesten Quadrats wÃ¤hlen', 'Zweiter Test (Pass 2) testet mit kleineren Intervallen fÃ¼r Feineinstellung', 'Formel: <strong>Alter Fluss Ã— (100 + Ã„nderung) / 100</strong>', 'Wert im Filamentprofil speichern'],
          tip: 'Bei LÃ¼cken auf der OberflÃ¤che ist der Fluss zu niedrig; bei Ãœberlauf zu hoch. Ziel: glatte, flache OberflÃ¤che.' },
        { icon: 'ğŸš€', title: 'Max Volumetric Speed Test', desc: 'Bestimmt die maximale Kunststoffmenge, die das Hotend schmelzen kann.',
          steps: ['<strong>Calibration â†’ Max Volumetric Speed</strong> wÃ¤hlen', 'Start- und Endwerte einstellen (PLA: 5-25 mmÂ³/s)', 'Testdruck starten und sorgfÃ¤ltig beobachten', 'Punkt finden, an dem der Druck matt wird oder degradiert', 'Wert <strong>2-3 mmÂ³/s VOR</strong> diesem Punkt verwenden', 'Diesen Wert als "Max Volumetric Speed" im Filamentprofil eingeben'],
          tip: 'Dieser Wert begrenzt ALLE Geschwindigkeitseinstellungen. Selbst bei 500 mm/s kann dieses Limit nicht Ã¼berschritten werden. PLA: ~21, PETG: ~14, ABS: ~18 sind typische Werte.' },
        { icon: 'ğŸ“', title: 'Vibration Compensation (Motor Noise)', desc: 'Input Shaper-Ã¤hnliche Vibrationsreduzierung. LÃ¶st Ghosting-Probleme.',
          steps: ['<strong>Calibration â†’ Vibration Compensation</strong> wÃ¤hlen', 'Drucker testet automatisch X- und Y-Achsen', 'Erzeugt Vibrationen bei verschiedenen Frequenzen fÃ¼r jede Achse', 'Findet automatisch Frequenzen mit geringster Vibration', 'Ergebnisse werden im Maschinenprofil gespeichert', 'Ghosting wird deutlich reduziert'],
          tip: 'Diese Kalibrierung funktioniert nur bei Bambu Lab Druckern. Verwendet LiDAR-Sensor zur Vibrationsmessung (X1C). Verwendet Beschleunigungsmesser bei P1S/A1.' },
        { icon: 'â†©ï¸', title: 'Retraction Kalibrierung', desc: 'RÃ¼ckzugsoptimierung zur LÃ¶sung von Stringing-Problemen.',
          steps: ['<strong>Calibration â†’ Retraction Test</strong> wÃ¤hlen', 'Entfernungsbereich einstellen (Direct Drive: 0.5-2mm)', 'Geschwindigkeitsbereich einstellen (25-45 mm/s)', 'Testdruck durchfÃ¼hren - NadeltÃ¼rme oder Raster', 'NIEDRIGSTEN Wert ohne Stringing finden', 'Diese Werte im Filamentprofil speichern'],
          tip: 'Da Bambu Drucker Direct Drive sind, reicht eine RÃ¼ckzugsdistanz von 0.5-2mm. Zu hoher Wert verursacht Verstopfung im Hotend.' }
      ]
    },
    calLabels: {
      tr: { howTo: 'NasÄ±l YapÄ±lÄ±r?' },
      en: { howTo: 'How to Do It?' },
      de: { howTo: 'Wie macht man es?' }
    },
    // Troubleshooting
    troubleshooting: {
      tr: {
        adhesion: { icon: 'ğŸ“‹', title: 'Tablaya YapÄ±ÅŸmama', cause: 'Tabla kirli, Z-offset yanlÄ±ÅŸ veya ilk katman Ã§ok hÄ±zlÄ±. Tabla sÄ±caklÄ±ÄŸÄ± yetersiz olabilir.', fix: 'TablayÄ± sabunlu suyla yÄ±kayÄ±n ve kurutun. Z-Offset\'i Bambu Studio\'dan kalibre edin (Calibration â†’ First Layer). Ä°lk katman hÄ±zÄ±nÄ± 20-30 mm/s\'ye dÃ¼ÅŸÃ¼rÃ¼n. Brim ekleyin (5-10mm).' },
        stringing: { icon: 'ğŸ•¸ï¸', title: 'Ä°pliklenme (Stringing)', cause: 'SÄ±caklÄ±k Ã§ok yÃ¼ksek, retraction yetersiz veya filament nemli.', fix: 'Nozzle sÄ±caklÄ±ÄŸÄ±nÄ± 5-10Â°C dÃ¼ÅŸÃ¼rÃ¼n. Retraction mesafesini 1-1.5mm yapÄ±n. Filamentin nemli olmadÄ±ÄŸÄ±ndan emin olun - AMS kurutma Ã¶zelliÄŸini aÃ§Ä±n veya harici kurutucu kullanÄ±n.' },
        ghosting: { icon: 'ğŸ‘»', title: 'Ghosting / Ringing', cause: 'Mekanik titreÅŸimler, gevÅŸek kayÄ±ÅŸlar veya yanlÄ±ÅŸ ivme ayarlarÄ±.', fix: 'Vibration Compensation kalibrasyonu Ã§alÄ±ÅŸtÄ±rÄ±n. KayÄ±ÅŸ gerginliklerini kontrol edin. YazÄ±cÄ±yÄ± saÄŸlam, titreÅŸimsiz bir zemine yerleÅŸtirin. BaskÄ± hÄ±zÄ±nÄ± dÃ¼ÅŸÃ¼rÃ¼n.' },
        clog: { icon: 'ğŸ”¥', title: 'Nozzle TÄ±kanmasÄ±', cause: 'Heat creep, yanmÄ±ÅŸ filament birikimi veya nemli/kirli filament.', fix: 'SoÄŸuk Ã§ekme (Cold Pull) yapÄ±n: Nozzle\'Ä± 250Â°C\'ye Ä±sÄ±tÄ±n, filamentin ucunu kaldÄ±rÄ±n, 90Â°C\'ye soÄŸutun ve sert Ã§ekin. PLA iÃ§in kapaÄŸÄ± aÃ§Ä±k bÄ±rakÄ±n. Hardened nozzle iÃ§in 280-300Â°C arasÄ± temizleme yapÄ±n.' },
        ams: { icon: 'ğŸ¨', title: 'AMS Besleme HatasÄ±', cause: 'Filament dolanmasÄ±, PTFE tÃ¼p tÄ±kanmasÄ± veya diÅŸli aÅŸÄ±nmasÄ±.', fix: 'Filament makara dolanmasÄ±nÄ± kontrol edin. PTFE tÃ¼pleri Ã§Ä±karÄ±p temizleyin. AMS diÅŸlilerini fÄ±rÃ§alayÄ±n. Filament uÃ§larÄ±nÄ± dÃ¼z kesin. Nemli filament AMS\'de kaymaya neden olur - kurutun.' },
        layer: { icon: 'ğŸ“š', title: 'Katman AyrÄ±lmasÄ±', cause: 'Katmanlar arasÄ± yapÄ±ÅŸma zayÄ±f. SÄ±caklÄ±k dÃ¼ÅŸÃ¼k veya fan Ã§ok yÃ¼ksek veya nemli filament.', fix: 'Nozzle sÄ±caklÄ±ÄŸÄ±nÄ± 5-10Â°C artÄ±rÄ±n. Fan hÄ±zÄ±nÄ± dÃ¼ÅŸÃ¼rÃ¼n (ABS/ASA iÃ§in %0-20). Kabin kapÄ±sÄ±nÄ± kapatÄ±n. Aux fan\'Ä± kapatÄ±n (ABS iÃ§in). Filamentin kuru olduÄŸundan emin olun.' }
      },
      en: {
        adhesion: { icon: 'ğŸ“‹', title: 'Bed Adhesion Issue', cause: 'Dirty bed, wrong Z-offset or first layer too fast. Bed temperature may be insufficient.', fix: 'Wash the bed with soapy water and dry it. Calibrate Z-Offset in Bambu Studio (Calibration â†’ First Layer). Reduce first layer speed to 20-30 mm/s. Add brim (5-10mm).' },
        stringing: { icon: 'ğŸ•¸ï¸', title: 'Stringing', cause: 'Temperature too high, insufficient retraction or wet filament.', fix: 'Reduce nozzle temperature by 5-10Â°C. Set retraction distance to 1-1.5mm. Make sure filament is not wet - enable AMS drying feature or use external dryer.' },
        ghosting: { icon: 'ğŸ‘»', title: 'Ghosting / Ringing', cause: 'Mechanical vibrations, loose belts or wrong acceleration settings.', fix: 'Run Vibration Compensation calibration. Check belt tensions. Place printer on a solid, vibration-free surface. Reduce print speed.' },
        clog: { icon: 'ğŸ”¥', title: 'Nozzle Clog', cause: 'Heat creep, burnt filament buildup or wet/dirty filament.', fix: 'Do a cold pull: Heat nozzle to 250Â°C, lift filament tip, cool to 90Â°C and pull hard. Keep lid open for PLA. For hardened nozzle, clean at 280-300Â°C.' },
        ams: { icon: 'ğŸ¨', title: 'AMS Feeding Error', cause: 'Filament tangle, PTFE tube clog or gear wear.', fix: 'Check filament spool tangle. Remove and clean PTFE tubes. Brush AMS gears. Cut filament ends straight. Wet filament causes slipping in AMS - dry it.' },
        layer: { icon: 'ğŸ“š', title: 'Layer Separation', cause: 'Weak inter-layer adhesion. Temperature too low or fan too high or wet filament.', fix: 'Increase nozzle temperature by 5-10Â°C. Reduce fan speed (0-20% for ABS/ASA). Close chamber door. Turn off aux fan (for ABS). Make sure filament is dry.' }
      },
      de: {
        adhesion: { icon: 'ğŸ“‹', title: 'Bett-Haftungsproblem', cause: 'Schmutziges Bett, falscher Z-Offset oder erste Schicht zu schnell. Betttemperatur kann unzureichend sein.', fix: 'Bett mit Seifenwasser waschen und trocknen. Z-Offset in Bambu Studio kalibrieren (Calibration â†’ First Layer). Erste Schichtgeschwindigkeit auf 20-30 mm/s reduzieren. Brim hinzufÃ¼gen (5-10mm).' },
        stringing: { icon: 'ğŸ•¸ï¸', title: 'FÃ¤denziehen (Stringing)', cause: 'Temperatur zu hoch, unzureichender RÃ¼ckzug oder feuchtes Filament.', fix: 'DÃ¼sentemperatur um 5-10Â°C senken. RÃ¼ckzugsdistanz auf 1-1.5mm einstellen. Sicherstellen, dass Filament nicht feucht ist - AMS-Trocknungsfunktion aktivieren oder externen Trockner verwenden.' },
        ghosting: { icon: 'ğŸ‘»', title: 'Ghosting / Ringing', cause: 'Mechanische Vibrationen, lockere Riemen oder falsche Beschleunigungseinstellungen.', fix: 'Vibration Compensation Kalibrierung ausfÃ¼hren. Riemenspannung prÃ¼fen. Drucker auf stabiler, vibrationsfreier OberflÃ¤che platzieren. Druckgeschwindigkeit reduzieren.' },
        clog: { icon: 'ğŸ”¥', title: 'DÃ¼senverstopfung', cause: 'Heat Creep, verbranntes Filament oder feuchtes/schmutziges Filament.', fix: 'Cold Pull durchfÃ¼hren: DÃ¼se auf 250Â°C erhitzen, Filamentspitze anheben, auf 90Â°C abkÃ¼hlen und fest ziehen. Deckel fÃ¼r PLA offen lassen. FÃ¼r gehÃ¤rtete DÃ¼se bei 280-300Â°C reinigen.' },
        ams: { icon: 'ğŸ¨', title: 'AMS ZufÃ¼hrungsfehler', cause: 'Filamentverwicklung, PTFE-Schlauch-Verstopfung oder ZahnradverschleiÃŸ.', fix: 'Filamentspulenverwicklung prÃ¼fen. PTFE-SchlÃ¤uche entfernen und reinigen. AMS-ZahnrÃ¤der bÃ¼rsten. Filamentenden gerade schneiden. Feuchtes Filament verursacht Rutschen im AMS - trocknen.' },
        layer: { icon: 'ğŸ“š', title: 'SchichtablÃ¶sung', cause: 'Schwache Zwischenschicht-Haftung. Temperatur zu niedrig oder LÃ¼fter zu hoch oder feuchtes Filament.', fix: 'DÃ¼sentemperatur um 5-10Â°C erhÃ¶hen. LÃ¼ftergeschwindigkeit reduzieren (0-20% fÃ¼r ABS/ASA). KammertÃ¼r schlieÃŸen. Aux-LÃ¼fter ausschalten (fÃ¼r ABS). Sicherstellen, dass Filament trocken ist.' }
      }
    },
    troubleLabels: {
      tr: { cause: 'Neden OluÅŸur?', fix: 'Ã‡Ã¶zÃ¼m' },
      en: { cause: 'Why Does It Occur?', fix: 'Solution' },
      de: { cause: 'Warum tritt es auf?', fix: 'LÃ¶sung' }
    },
    // Chart labels
    chartLabels: {
      tr: {
        radar: ['HÄ±z', 'Kalibrasyon', 'Ã‡oklu Renk', 'YazÄ±lÄ±m', 'GÃ¼venilirlik'],
        radarBambu: 'Bambu Lab',
        radarOthers: 'DiÄŸer Markalar',
        time: ['Duvarlar', 'Dolgu', 'Hareket', 'Destek', 'Ä°lk Katman']
      },
      en: {
        radar: ['Speed', 'Calibration', 'Multi-Color', 'Software', 'Reliability'],
        radarBambu: 'Bambu Lab',
        radarOthers: 'Other Brands',
        time: ['Walls', 'Infill', 'Travel', 'Support', 'First Layer']
      },
      de: {
        radar: ['Geschwindigkeit', 'Kalibrierung', 'Mehrfarbig', 'Software', 'ZuverlÃ¤ssigkeit'],
        radarBambu: 'Bambu Lab',
        radarOthers: 'Andere Marken',
        time: ['WÃ¤nde', 'FÃ¼llung', 'Bewegung', 'StÃ¼tzen', 'Erste Schicht']
      }
    }
  };
</script>
<script>
  // Tab switching
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const tabId = btn.dataset.tab;

      // Update buttons
      document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      // Update panels
      document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
      document.getElementById('tab-' + tabId).classList.add('active');

      // Init charts if dashboard
      if (tabId === 'dashboard') initCharts();
      // Init filament if filaments
      if (tabId === 'filaments') initFilament();
      // Init calibration if calibration
      if (tabId === 'calibration') initCalibration();
    });
  });

  // Get current language from i18n data
  const currentLang = window.bambuI18n.lang;
  const filamentData = window.bambuI18n.filaments[currentLang];
  const filamentLabels = window.bambuI18n.filamentLabels[currentLang];

  function initFilament() {
    updateFilamentDetail(0);
  }

  function updateFilamentDetail(index) {
    const f = filamentData[index];
    const labels = filamentLabels;
    document.getElementById('filamentDetailContent').innerHTML = `
      <div class="detail-header">
        <span class="detail-icon">${f.icon}</span>
        <h3>${f.name}</h3>
      </div>
      <p class="detail-desc">${f.desc}</p>

      <div class="param-grid">
        <div class="param-card">
          <div class="param-icon-wrap nozzle">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 2v6m0 0l-3-3m3 3l3-3M8 12h8M9 16l3 6 3-6"/>
            </svg>
          </div>
          <div class="param-info">
            <span class="param-label">${labels.nozzle}</span>
            <span class="param-value">${f.nozzle}<span class="param-unit">Â°C</span></span>
          </div>
        </div>

        <div class="param-card">
          <div class="param-icon-wrap bed">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="2" y="14" width="20" height="4" rx="1"/>
              <path d="M4 14v-2a2 2 0 012-2h12a2 2 0 012 2v2"/>
              <path d="M12 10V6m-3 4V8m6 2V8"/>
            </svg>
          </div>
          <div class="param-info">
            <span class="param-label">${labels.bed}</span>
            <span class="param-value">${f.bed}<span class="param-unit">Â°C</span></span>
          </div>
        </div>

        <div class="param-card">
          <div class="param-icon-wrap fan">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="3"/>
              <path d="M12 5a3 3 0 0 1 0-3 3 3 0 0 1 3 3 3 3 0 0 1-3 0zM19 12a3 3 0 0 1 3 0 3 3 0 0 1-3 3 3 3 0 0 1 0-3zM12 19a3 3 0 0 1 0 3 3 3 0 0 1-3-3 3 3 0 0 1 3 0zM5 12a3 3 0 0 1-3 0 3 3 0 0 1 3-3 3 3 0 0 1 0 3z"/>
            </svg>
          </div>
          <div class="param-info">
            <span class="param-label">${labels.fan}</span>
            <span class="param-value">${f.fan}<span class="param-unit">%</span></span>
          </div>
        </div>

        <div class="param-card">
          <div class="param-icon-wrap speed">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
            </svg>
          </div>
          <div class="param-info">
            <span class="param-label">${labels.maxVol}</span>
            <span class="param-value">${f.maxVol}<span class="param-unit">mmÂ³/s</span></span>
          </div>
        </div>
      </div>

      <div class="info-grid">
        <div class="info-card">
          <div class="info-icon-wrap chamber">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <path d="M3 9h18M9 21V9"/>
            </svg>
          </div>
          <div class="info-content">
            <span class="info-label">${labels.chamber}</span>
            <span class="info-value">${f.chamber}</span>
          </div>
        </div>

        <div class="info-card">
          <div class="info-icon-wrap plate">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="2" y="6" width="20" height="12" rx="2"/>
              <path d="M6 10h12M6 14h8"/>
            </svg>
          </div>
          <div class="info-content">
            <span class="info-label">${labels.plate}</span>
            <span class="info-value">${f.plate}</span>
          </div>
        </div>

        <div class="info-card full-width">
          <div class="info-icon-wrap dry">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="5"/>
              <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
            </svg>
          </div>
          <div class="info-content">
            <span class="info-label">${labels.dry}</span>
            <span class="info-value mono">${f.dry}</span>
          </div>
        </div>
      </div>

      ${f.warning ? `
        <div class="alert-box warning">
          <div class="alert-icon">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/>
              <line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
          </div>
          <div class="alert-content">
            <h4>${labels.warning}</h4>
            <p>${f.warning}</p>
          </div>
        </div>
      ` : ''}

      <div class="alert-box tip">
        <div class="alert-icon">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
            <line x1="12" y1="17" x2="12.01" y2="17"/>
          </svg>
        </div>
        <div class="alert-content">
          <h4>${labels.tip}</h4>
          <p>${f.tip}</p>
        </div>
      </div>
    `;
  }

  document.querySelectorAll('.filament-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const index = parseInt(btn.dataset.filament);

      document.querySelectorAll('.filament-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      updateFilamentDetail(index);
    });
  });

  // Calibration Data from i18n
  const calData = window.bambuI18n.calibration[currentLang];
  const calLabels = window.bambuI18n.calLabels[currentLang];

  function initCalibration() {
    updateCalDetail(0);
  }

  function updateCalDetail(index) {
    const step = calData[index];
    document.getElementById('calDetailContent').innerHTML = `
      <div class="detail-header">
        <span class="detail-icon">${step.icon}</span>
        <h3>${step.title}</h3>
      </div>
      <p class="detail-desc">${step.desc}</p>
      <div class="detail-steps">
        <h4>${calLabels.howTo}</h4>
        <ol>
          ${step.steps.map(s => `<li>${s}</li>`).join('')}
        </ol>
      </div>
      <div class="detail-tip">
        <span>ğŸ’¡</span>
        <p>${step.tip}</p>
      </div>
    `;
  }

  document.querySelectorAll('.cal-step-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const stepIndex = parseInt(btn.dataset.step);

      document.querySelectorAll('.cal-step-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      updateCalDetail(stepIndex);
    });
  });

  // Troubleshooting solutions from i18n
  const solutions = window.bambuI18n.troubleshooting[currentLang];
  const troubleLabels = window.bambuI18n.troubleLabels[currentLang];

  document.querySelectorAll('.problem-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const problemId = btn.dataset.problem;
      const sol = solutions[problemId];

      document.querySelectorAll('.problem-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      document.getElementById('solutionPanel').innerHTML = `
        <div class="solution-content">
          <div class="solution-header">
            <span>${sol.icon}</span>
            <h3>${sol.title}</h3>
          </div>
          <div class="solution-grid">
            <div class="cause-box">
              <h4>${troubleLabels.cause}</h4>
              <p>${sol.cause}</p>
            </div>
            <div class="fix-box">
              <h4>${troubleLabels.fix}</h4>
              <p>${sol.fix}</p>
            </div>
          </div>
        </div>
      `;
    });
  });

  // Charts
  let radarChart = null;
  let timeChart = null;
  const chartLabels = window.bambuI18n.chartLabels[currentLang];

  function initCharts() {
    if (radarChart) return;

    const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
    const textColor = isDark ? '#94a3b8' : '#475569';
    const gridColor = isDark ? '#334155' : '#e2e8f0';

    // Radar Chart
    const ctxRadar = document.getElementById('radarChart')?.getContext('2d');
    if (ctxRadar) {
      radarChart = new Chart(ctxRadar, {
        type: 'radar',
        data: {
          labels: chartLabels.radar,
          datasets: [{
            label: chartLabels.radarBambu,
            data: [10, 10, 10, 9, 9],
            backgroundColor: 'rgba(0, 174, 66, 0.2)',
            borderColor: '#00AE42',
            pointBackgroundColor: '#00AE42'
          }, {
            label: chartLabels.radarOthers,
            data: [6, 5, 4, 6, 7],
            backgroundColor: 'rgba(148, 163, 184, 0.2)',
            borderColor: '#94a3b8',
            pointBackgroundColor: '#94a3b8'
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              grid: { color: gridColor },
              angleLines: { display: false },
              pointLabels: { color: textColor, font: { size: 11 } },
              suggestedMin: 0,
              suggestedMax: 10,
              ticks: { display: false }
            }
          },
          plugins: {
            legend: {
              position: 'bottom',
              labels: { color: textColor, font: { size: 11 } }
            }
          }
        }
      });
    }

    // Time Chart
    const ctxTime = document.getElementById('timeChart')?.getContext('2d');
    if (ctxTime) {
      timeChart = new Chart(ctxTime, {
        type: 'doughnut',
        data: {
          labels: chartLabels.time,
          datasets: [{
            data: [40, 25, 15, 12, 8],
            backgroundColor: ['#059669', '#00AE42', '#34d399', '#6ee7b7', '#94a3b8'],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'right',
              labels: { color: textColor, font: { size: 10 } }
            }
          }
        }
      });
    }
  }

  // Init on page load
  document.addEventListener('DOMContentLoaded', () => {
    setTimeout(() => {
      initCharts();
      initFilament();
      initCalibration();
    }, 100);
  });

  // Re-init on Astro navigation
  document.addEventListener('astro:page-load', () => {
    radarChart = null;
    timeChart = null;
    setTimeout(() => {
      initCharts();
      initFilament();
      initCalibration();
    }, 100);
  });
</script>
